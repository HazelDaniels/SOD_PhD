---
title: "Eradication Effectiveness"
author: "Hazel Daniels"
date: "April 24, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
AllSites <- read_xlsx("BasicData.xlsx")
head(AllSites)
AllSites$VegBin <- as.numeric(as.character(AllSites$VegBin))
AllSites$SoilBin <- as.numeric(as.character(AllSites$SoilBin))
AllSites$TrtBin <- as.numeric(as.character(AllSites$TrtBin))
head(AllSites)
```

# Vegetation
## Fitting a model for veg
```{r}
veg_null = glm(VegBin~1, family = binomial, data=AllSites)
veg_full = glm(VegBin~Lineage * TrtBin * SoilBin, family=binomial, data=AllSites)
step(veg_null, scope = list(upper=veg_full), direction="both", test="Chisq", data=AllSItess)
#VegBin~SoilBin + TrtBin + SoilBin:TrtBin

#library(rJava)
#library(glmulti)
#model_full2 <- glmulti(VegBin ~ Lineage * TrtBin * SoilBin, data=AllSites, crit=bic, method = "g")
#VegBin~1+TrtBin+SoilBin:TrtBin
#model_full3 <- glmulti(VegBin ~ Lineage * TrtBin * SoilBin, data=AllSites, crit=aic, method = "g")
#VegBin~1+TrtBin+SoilBin:TrtBin
```

## Fitting a model for NA1 veg only
```{r}
#Subsetting data
NA1Sites <- subset(AllSites, AllSites$Lineage == "NA1")

NAV_null = glm(VegBin~1, family = binomial, data=NA1Sites)
NAV_full = glm(VegBin~TrtBin * SoilBin, family=binomial, data=NA1Sites)
step(NAV_null, scope = list(upper=NAV_full), direction="both", test="Chisq", data=NA1Sites)
#VegBin~SoilBin + TrtBin

#NAV_full2 <- glmulti(VegBin ~ TrtBin * SoilBin, data=NA1Sites, crit=bic, method = "g")
#VegBin~1+TrtBin+SoilBin:TrtBin
#NAV_full3 <- glmulti(VegBin ~ TrtBin * SoilBin, data=NA1Sites, crit=aic, method = "g")
#VegBin~1+TrtBin+SoilBin:TrtBin
```

## Fitting a model for EU1 veg only
```{r}
#Subsetting data
EU1Sites <- subset(AllSites, AllSites$Lineage == "EU1")

EUV_null = glm(VegBin~1, family = binomial, data=EU1Sites)
EUV_full = glm(VegBin~TrtBin * SoilBin, family=binomial, data=EU1Sites)
step(EUV_null, scope = list(upper=EUV_full), direction="both", test="Chisq", data=EU1Sites)
#VegBin~1

#EUV_full2 <- glmulti(VegBin ~ TrtBin * SoilBin, data=EU1Sites, crit=bic, method = "g")
#VegBin~1
#EUV_full3 <- glmulti(VegBin ~ TrtBin * SoilBin, data=EU1Sites, crit=aic, method = "g")
#VegBin~1
```

## Logistic Regression for predicting Positive Veg, Generally
```{r}
#Is positive veg predicted by treatment and positive soil &/or interaction? (model from stepwise fit)
LRVeg_TS1 <- glm(VegBin~SoilBin + TrtBin + SoilBin:TrtBin, family=binomial, data=AllSites)
summary(LRVeg_TS1)

#Is positive veg predicted by treatment and positive soil &/or interaction? (model from glmulti fit)
LRVeg_TS2 <- glm(VegBin~1+TrtBin+SoilBin:TrtBin, family=binomial, data=AllSites)
summary(LRVeg_TS2)
```

#Interpretation (of LRVeg_TS2)
For a given site, any treatment changes the log odds of there being positive vegetation by -2.06.

Intercept = 1 (pos veg on plot). It looks like there's a significant predictive quality for whether a site has been treated as to whether there is positive veg. In other words, a treated site has a negative association with positive veg (is less likely to have positive veg than an untreated site). 

It is plausible that the data eminate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant. Given a 1 unit increase in TrtBin, we expect a loss of 2 in VegBin (e.g. when Treatment is applied, we expect postive veg to decrease from "present" to "not present").

> 1-pchisq(79.728-60.026, 58-55)

[1] 0.0001956716

## Logistic regession for predicting positive veg, NA1 only
```{r}
#Is NA1 Positive veg predicted by treatment and positive soil? (model from stepwise fit)
NA1_TS1 <- glm(VegBin~SoilBin + TrtBin, family=binomial, data=NA1Sites)
summary(NA1_TS1)

#Is NA1 Positive veg predicted by treatment and positive soil &/or interaction? (model from glmulti fit)
NA1_TS2 <- glm(VegBin~1+TrtBin+SoilBin:TrtBin, family=binomial, data=NA1Sites)
summary(NA1_TS2)
```

#Interpretation (of NA1_TS1)
For a given NA1 site, any treatment changes the log odds of there being positive vegetation by -1.73.

Intercept = 1 (as in, yes there's pos veg on plot), it looks like there's a significant predictive quality for whether a site has been treated as to whether there is positive veg. In other words, a treated site has a negative association with positive veg (is less likely to have positive veg than an untreated site). 

It is plausible that the data eminate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

> 1-pchisq(56.814-41.192, 40-38)

[1] 0.0004052526


## Logistic Regression for predicting positive Veg, EU1 only
```{r}
#Is EU1 Positive veg predicted by any factor?
EU1_TS1 <- glm(VegBin~SoilBin * TrtBin, family=binomial, data=EU1Sites)
summary(EU1_TS1)

summary(EUV_null)
```

#Interpretation
For a given EU1 site, no factors were found to have any predictive quality for positive vegetation.

There are no factors with any predictive quality for EU1 positive veg. We accept the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

> 1-pchisq(19.069-18.421, 17-15)

[1] 0.7232502


# Soil
## Fitting a model for soil
```{r}
soil_null = glm(SoilBin~1, family = binomial, data=AllSites)
soil_full = glm(SoilBin~Lineage * TrtBin * VegBin, family=binomial, data=AllSites)
step(soil_null, scope = list(upper=soil_full), direction="both", test="Chisq", data=AllSItess)
#SoilBin~VegBin

#soil_full2 <- glmulti(SoilBin ~ Lineage * TrtBin * VegBin, data=AllSites, crit=bic, method = "g")
#SoilBin~1+VegBin
#soil_full3 <- glmulti(SoilBin ~ Lineage * TrtBin * VegBin, data=AllSites, crit=aic, method = "g")
#SoilBin~1+VegBin
```

## Fitting a model for NA1 soil only
```{r}
NAS_null = glm(SoilBin~1, family = binomial, data=NA1Sites)
NAS_full = glm(SoilBin~TrtBin * VegBin, family=binomial, data=NA1Sites)
step(NAS_null, scope = list(upper=NAS_full), direction="both", test="Chisq", data=NA1Sites)
#SoilBin~VegBin

#NAS_full2 <- glmulti(SoilBin ~ TrtBin * VegBin, data=NA1Sites, crit=bic, method = "g")
#SoilBin~1+VegBin
#NAS_full3 <- glmulti(SoilBin ~ TrtBin * VegBin, data=NA1Sites, crit=aic, method = "g")
#SoilBin~1+VegBin
```

## Fitting a model for EU1 soil only
```{r}
EUS_null = glm(SoilBin~1, family = binomial, data=EU1Sites)
EUS_full = glm(SoilBin~TrtBin * VegBin, family=binomial, data=EU1Sites)
step(EUS_null, scope = list(upper=EUS_full), direction="both", test="Chisq", data=EU1Sites)
#SoilBin ~ 1

#EUS_full2 <- glmulti(SoilBin ~ TrtBin * VegBin, data=EU1Sites, crit=bic, method = "g")
#SoilBin ~ 1
#EUS_full3 <- glmulti(SoilBin ~ TrtBin * VegBin, data=EU1Sites, crit=aic, method = "g")
#SoilBin ~ 1
```

## Logistic Regression for predicting Positive Soil, Generally
```{r}
#Is positive soil predicted by positive veg alone? (model from stepwise fit & glmulti fit)
LRSoil_Veg1 <- glm(SoilBin~VegBin, family=binomial, data=AllSites)
summary(LRSoil_Veg1)
```

#Interpretation
For a given site, the presence of positive vegetation changes the log odds of there being positive soil by 2.61.

Intercept = 1 (as in, yes there's pos soil on plot), it looks like there's a significant predictive quality for whether a site has positive veg as to whether there is positive soil. In other words, a site with positive veg is more likely to have positive soil than a site without positive veg. 

It is plausible that the data eminate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

> 1-pchisq(64.656-54.494, 58-57)

[1] 0.00143365

## Logistic regression for predicting positive soil, NA1 only
```{r}
#Is NA1 Positive soil predicted by positive veg alone? (model from stepwise fit & glmulti fit)
NA1_v1 <- glm(SoilBin~VegBin, family=binomial, data=NA1Sites)
summary(NA1_v1)
```

#Interpretation
For a given NA1 site, there are no factors with a predictive quality, but at the same time, the model selected is the most appropriate one.

It is plausible that the data eminate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

> 1-pchisq(37.478-26.734, 40-39)

[1] 0.00104618

## Logistic regression for predicting positive soil, EU1 only
```{r}
EU1_v1 <- glm(SoilBin~VegBin * TrtBin, family=binomial, data=EU1Sites)
summary(EU1_v1)

summary(EUS_null)
```

#Interpretation
For a given EU1 site, no factors were found to have any predictive quality for positive vegetation.

We accept the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

> 1-pchisq(24.057-23.620, 17-16)

[1] 0.508574

#Take Away Message
Treatment is predicted to affect NA1 veg. In turn, whether or not there is positive veg is predicted to affect whether soil is also found to be positive, though this is speaking generally and not for NA1 specifically (perhaps the sample sizes are too small to make those kinds of associations). Treatment is predicted to reduce veg, which reduces the liklihood of positive soil. There are no factors which predict EU1 veg or soil.
