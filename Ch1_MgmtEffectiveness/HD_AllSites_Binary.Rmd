---
title: "Eradication Effectiveness Binary"
author: "Hazel Daniels"
output:
  html_document:
    df_print: paged
updated: April 30, 2020
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
AllSites <- read_xlsx("BasicData.xlsx")
head(AllSites)
AllSites$VegBin <- as.numeric(as.character(AllSites$VegBin))
AllSites$SoilBin <- as.numeric(as.character(AllSites$SoilBin))
AllSites$TrtBin <- as.numeric(as.character(AllSites$TrtBin))
head(AllSites)
```

# Vegetation
## Fitting a model for veg
```{r}
veg_null = glm(VegBin~1, family = binomial, data=AllSites)
veg_full = glm(VegBin~Lineage * TrtBin * SoilBin, family=binomial, data=AllSites)
step(veg_null, scope = list(upper=veg_full), direction="both", test="Chisq", data=AllSItess)
#VegBin ~ TrtBin + SoilBin
```

## Fitting a model for NA1 veg only
```{r}
#Subsetting data
NA1Sites <- subset(AllSites, AllSites$Lineage == "NA1")

NAV_null = glm(VegBin~1, family = binomial, data=NA1Sites)
NAV_full = glm(VegBin~TrtBin * SoilBin, family=binomial, data=NA1Sites)
step(NAV_null, scope = list(upper=NAV_full), direction="both", test="Chisq", data=NA1Sites)
#VegBin ~ SoilBin + TrtBin
```

## Fitting a model for EU1 veg only
```{r}
#Subsetting data
EU1Sites <- subset(AllSites, AllSites$Lineage == "EU1")

EUV_null = glm(VegBin~1, family = binomial, data=EU1Sites)
EUV_full = glm(VegBin~TrtBin * SoilBin, family=binomial, data=EU1Sites)
step(EUV_null, scope = list(upper=EUV_full), direction="both", test="Chisq", data=EU1Sites)
#VegBin ~ SoilBin + TrtBin
```

## Logistic Regression for predicting positive veg, Generally
```{r}
#Is positive veg predicted by treatment and positive soil? (model from stepwise fit)
LRVeg_TS <- glm(VegBin ~ TrtBin + SoilBin, family=binomial, data=AllSites)
summary(LRVeg_TS)

1-pchisq(120.352-93.669, 87-85)
```

## Interpretation (of LRVeg_TS1)
For a given site, any treatment changes the log odds of there being positive vegetation by -1.9.

Intercept = 1 (pos veg on plot). It looks like there's a significant predictive quality for whether a site has been treated as to whether there is positive veg. In other words, a treated site has a negative association with positive veg (is less likely to have positive veg than an untreated site). 

It is plausible that the data emanate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant. Given a 1 unit increase in TrtBin, we expect a loss of 2 in VegBin (e.g. when Treatment is applied, we expect positive veg to decrease from "present" to "not present").

chi square 0.000001606424

## Logistic regession for predicting positive veg, NA1 only
```{r}
#Is NA1 Positive veg predicted by treatment and positive soil? (model from stepwise fit)
NA1_TS <- glm(VegBin~SoilBin + TrtBin, family=binomial, data=NA1Sites)
summary(NA1_TS)

1-pchisq(70.852-49.204, 51-49)
```

## Interpretation (of NA1_TS)
For a given NA1 site, any treatment changes the log odds of there being positive vegetation by -2.3.

Intercept = 1 (as in, yes there's pos veg on plot), it looks like there's a significant predictive quality for whether a site has been treated as to whether there is positive veg. In other words, a treated site has a negative association with positive veg (is less likely to have positive veg than an untreated site). 

It is plausible that the data emanate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

chi square 0.00001991574

## Logistic Regression for predicting positive Veg, EU1 only
```{r}
#Is EU1 Positive veg predicted by treatment and positive soil? (model from stepwise fit)
EU1_TS1 <- glm(VegBin~SoilBin * TrtBin, family=binomial, data=EU1Sites)
summary(EU1_TS)

1-pchisq(49.461-40.025, 35-32)
```

## Interpretation
For a given EU1 site, any treatment changes the log odds of there being positive vegetation by -1.9.

Intercept = 1 (as in, yes there's pos veg on plot), it looks like there's a significant predictive quality for whether a site has been treated as to whether there is positive veg. In other words, a treated site has a negative association with positive veg (is less likely to have positive veg than an untreated site). 

It is plausible that the data emanate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

chi square 0.02402205

# Soil
## Fitting a model for soil
```{r}
soil_null = glm(SoilBin~1, family = binomial, data=AllSites)
soil_full = glm(SoilBin~Lineage * TrtBin * VegBin, family=binomial, data=AllSites)
step(soil_null, scope = list(upper=soil_full), direction="both", test="Chisq", data=AllSItess)
#SoilBin ~ VegBin + Lineage
```

## Fitting a model for NA1 soil only
```{r}
NAS_null = glm(SoilBin~1, family = binomial, data=NA1Sites)
NAS_full = glm(SoilBin~TrtBin * VegBin, family=binomial, data=NA1Sites)
step(NAS_null, scope = list(upper=NAS_full), direction="both", test="Chisq", data=NA1Sites)
#SoilBin ~ VegBin + TrtBin
```

## Fitting a model for EU1 soil only
```{r}
EUS_null = glm(SoilBin~1, family = binomial, data=EU1Sites)
EUS_full = glm(SoilBin~TrtBin * VegBin, family=binomial, data=EU1Sites)
step(EUS_null, scope = list(upper=EUS_full), direction="both", test="Chisq", data=EU1Sites)
#SoilBin ~ VegBin
```

## Logistic Regression for predicting Positive Soil, Generally
```{r}
#Is positive soil predicted by positive veg alone? (model from stepwise fit)
LRSoil_VL <- glm(SoilBin ~ VegBin + Lineage, family=binomial, data=AllSites)
summary(LRSoil_VL)

1-pchisq(91.816-76.226, 87-85)
```

## Interpretation
For a given site, the presence of positive vegetation changes the log odds of there being positive soil by 2.33.

Intercept = 1 (as in, yes there's pos soil on plot), it looks like there's a significant predictive quality for whether a site has positive veg as to whether there is positive soil. In other words, a site with positive veg is more likely to have positive soil than a site without positive veg. 

It is plausible that the data emanate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

chi square 0.0004117888

## Logistic regression for predicting positive soil, NA1 only
```{r}
#Is NA1 Positive soil predicted by positive veg alone? (model from stepwise fit)
NA1_VT <- glm(SoilBin~VegBin + TrtBin, family=binomial, data=NA1Sites)
summary(NA1_VT)

1-pchisq(44.650-32.521, 51-49)
```

## Interpretation
For a given NA1 site, there are no factors with a predictive quality, but at the same time, the model selected is the most appropriate one.

It is plausible that the data emanate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

chi square 0.00232392

## Logistic regression for predicting positive soil, EU1 only
```{r}
EU1_V <- glm(SoilBin~VegBin, family=binomial, data=EU1Sites)
summary(EU1_V)

1-pchisq(44.316-39.582, 35-34)
```

## Interpretation
For a given EU1 site, the presence of positive vegetation changes the log odds of there being positive soil by 1.7.

Intercept = 1 (as in, yes there's pos soil on plot), it looks like there's a significant predictive quality for whether a site has positive veg as to whether there is positive soil. In other words, a site with positive veg is more likely to have positive soil than a site without positive veg. 

It is plausible that the data emanate from a logistic model that includes these variables. We can reject the null hypothesis that the deviance of the model with these variables is the same as the deviance of the model with only the constant.

chi square 0.2957203

#Take Away Message
Treatment is predicted to affect (reduce) residual vegegation infected by both NA1 and EU1. In turn, whether or not there is positive veg is predicted to affect whether soil is also found to be positive, though this is speaking generally and not for NA1 specifically. Treatment is predicted to reduce veg, which reduces the likelihood of positive soil.

#Are current treatments effectively reducing P. ramorum infections in soil and vegetation?
```{r}
anova.vtrt <- aov(VegBin~TrtBin, data=AllSites)
summary(anova.vtrt)

anova.strt <- aov(SoilBin~TrtBin, data=AllSites)
summary(anova.strt)

anova.sveg <- aov(SoilBin~VegBin, data=AllSites)
summary(anova.sveg)
```

#Is wildfire better than current treatments at removing P. ramorum from sites?
```{r}
anova.vburn <- aov(VegBin~Wildfire * TrtBin, data=AllSites)
summary(anova.vburn)

anova.sburn <- aov(SoilBin~Wildfire * TrtBin, data=AllSites)
summary(anova.sburn)
```